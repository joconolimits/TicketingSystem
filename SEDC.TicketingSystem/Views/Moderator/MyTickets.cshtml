@model IEnumerable<SEDC.TicketingSystem.Models.Ticket>

@{
    ViewBag.Title = "MyTickets";
    if (Convert.ToInt32(Session["IsAdmin"]) == 2)
    {
        Layout = "~/Views/Shared/_SuperAdminLayout.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_ModeratorLayout.cshtml";
    }
}
<div class="container-fluid blue-line shadow2">
    <h3 class="colorletter">My Tickets</h3>
    <hr />
    <div class="">
        <div>
            <br />
            <span class="msgText">Filter by: </span>
            @Html.DropDownList("CategoryID", null, "Category", htmlAttributes: new { @class = "" })
            <select id="status" name="status">
                <option value="">Status</option>
                <option value="1">Pending</option>
                <option value="2">Wait reply</option>
                <option value="3">Closed</option>
            </select>
        </div>
        <br />
        <input type="hidden" value="1" id="key" /> @*This key just tells us to filter per user as well*@
        <table class="table">
            <thead>
                <tr class="msgTextNoMrg">
                    <th>
                        @Html.DisplayNameFor(model => model.ID)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Title)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Status)
                    </th>
                    <th>
                        Category
                    </th>
                    <th>
                        Moderator
                    </th>
                    <th>
                        Author
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.OpenDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.CloseDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.WorkHours)
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="tickets">
                @foreach (var item in Model)
                {
                    string status = "";
                    if ((int)item.Status == 1)
                    {
                        status = "danger";
                    }
                    if ((int)item.Status == 2)
                    {
                        status = "info";
                    }
                    if ((int)item.Status == 3)
                    {
                        status = "success";
                    }

                    <tr class="@status">
                        <td>
                            @Html.DisplayFor(modelItem => item.ID)
                        </td>
                        <td>
                            @Html.ActionLink(item.Title.ToString(), "Details", new { id = item.ID })
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Status)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Category.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Moderator.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Owner.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.OpenDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.CloseDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.WorkHours)
                        </td>
                        <td>
                            @Html.ActionLink("Details", "Details", new { id = item.ID }, new { @class = "button modern-button-purple" })
                            @*Only Super Admin can delete tickets*@
                            @if (Convert.ToInt32(Session["IsAdmin"]) == 2)
                            {
                                <span></span>

                                @Html.ActionLink("Edit", "Edit", "Tickets", new { id = item.ID }, new { @class = "button modern-button" })

                                <span></span>
                                @Html.ActionLink("Delete", "Delete", "Tickets", new { id = item.ID }, new { @class = "button modern-button-red" })
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section OrderByScript{
    <script src="~/Scripts/AdminFilterBy.js"></script>}